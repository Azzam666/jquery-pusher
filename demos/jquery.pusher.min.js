/*! jquery-pusher 0.1.1 2013-07-20
https://github.com/salvan13/jquery-pusher
Original author: Antonio Salvati - @salvan13 - salvan13@gmail.com
Licensed under the MIT license
 */
(function(t,n,i){"use strict";function a(n,i){this.element=n,this.options=t.extend({},o,i),this._defaults=o,this._name=e,this.init()}var e="pusher",o={watch:"a",initialPath:n.location.pathname,before:function(t){t()},handler:function(){},after:function(){},fail:function(){n.alert("Failed to load "+this.state.path)},onStateCreation:function(){}};a.prototype={init:function(){var i=this;if(history.pushState){var a=r({path:i.options.initialPath},i.options.onStateCreation);history.replaceState(a,null,a.path),t(i.element).on("click",i.options.watch,function(n){n.preventDefault();var a=r({path:t(this).attr("href"),elem:t(this)},i.options.onStateCreation);p(i,a,!0)}),n.addEventListener("popstate",function(t){p(i,t.state)})}}};var r=function(t,n){var i={};return t=t||{},i.path=t.path,i.time=(new Date).getTime(),n&&n(i,t.elem),i},p=function(n,i,a){if(i){var e={state:i,get:function(t){return s(e.res,t)}},o=function(){t.ajax({type:"GET",url:i.path}).done(function(t){e.res=t,a&&history.pushState(i,null,i.path),n.options.handler.apply(e)}).fail(function(){n.options.fail.apply(e)}).always(function(){n.options.after.apply(e)})};n.options.before.apply(e,[o])}},s=function(n,i){var a=t("<root>").html(n),e=a.find(i);return e};t.fn[e]=function(n){t.data(i,"plugin_"+e)||t.data(i,"plugin_"+e,new a(this,n))}})(jQuery,window,document);